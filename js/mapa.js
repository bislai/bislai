function nameFn(t){return t&&t.properties?t.properties.distrito:null}function nameLength(t){var e=nameFn(t);return e?e.length:0}function fillFn(t){return color(nameLength(t))}function clicked(t){var e,a,r;if(t&&centered!==t){var n=path.centroid(t);e=n[0],a=n[1],r=4,centered=t}else e=width/2,a=height/2,r=1,centered=null;mapLayer.selectAll("path").style("fill",function(t){return centered&&t===centered?"#D5708B":fillFn(t)}),g.transition().duration(750).attr("transform","translate("+width/2+","+height/2+")scale("+r+")translate("+-e+","+-a+")")}function mouseover(t){d3.select(this).style("fill","orange"),textArt(nameFn(t))}function mouseout(t){mapLayer.selectAll("path").style("fill",function(t){return centered&&t===centered?"#D5708B":fillFn(t)}),effectLayer.selectAll("text").transition().style("opacity",0).remove(),bigText.text("")}var width=960,height=500,centered,color=d3.scale.linear().domain([1,20]).clamp(!0).range(["#fff","#409A99"]),projection=d3.geo.mercator().scale(1500).center([-74,4.5]).translate([width/2,height/2]),path=d3.geo.path().projection(projection),margin={top:50,right:50,bottom:50,left:110},widthH=1200-margin.left-margin.right,heightH=500-margin.top-margin.bottom,svg=d3.select(".mapa").append("svg").attr("class","mapa-elecciones").attr("width",widthH+margin.left+margin.right).attr("height",heightH+margin.top+margin.bottom).append("g").attr("transform","translate("+(margin.left-margin.right)+","+margin.top+")");svg.append("rect").attr("class","background").attr("width",width).attr("height",height).on("click",clicked);var g=svg.append("g"),effectLayer=g.append("g").classed("effect-layer",!0),mapLayer=g.append("g").classed("map-layer",!0),dummyText=g.append("text").classed("dummy-text",!0).attr("x",10).attr("y",30).style("opacity",0),bigText=g.append("text").classed("big-text",!0).attr("x",20).attr("y",45);d3.json("mapas/distrito-electoral-zaragoza.geojson",function(t,e){var a=e.features;color.domain([0,d3.max(a,nameLength)]),mapLayer.selectAll("path").data(a).enter().append("path").attr("d",path).attr("vector-effect","non-scaling-stroke").style("fill",fillFn).on("mouseover",mouseover).on("mouseout",mouseout).on("click",clicked)});